This code implements the Miller-Rabin primality test to determine if a given number is prime or not. The is_prime/2 predicate returns false if the number is composite and true if the number is probably prime. The implementation is deterministic for numbers less than 3.415e+14 and probabilistic for larger numbers. The code also includes functions to generate deterministic and random witnesses, and to find the values of D and S for a given odd integer. The Miller-Rabin test is performed using these values to determine the primality of the input number.