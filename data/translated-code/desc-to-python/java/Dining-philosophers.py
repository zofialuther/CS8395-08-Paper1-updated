```python
# Python code not available as the original code is in Java and the translation would require significant restructuring and rewriting of the code.
```